<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wawacity Addon - Stremio</title>
    <meta property="og:title" content="Wawacity Addon - Stremio" />
    <meta property="og:url" content="https://wawacity.diy" />
    <meta property="og:description" content="Accès au contenu de Wawacity via Stremio & AllDebrid (non officiel)" />
    <meta name="theme-color" content="#FF7F00">
    <link rel="icon" href="/static/favicon.ico">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <style>
        /* --- CSS Variables --- */
        :root {
            --color-bg-primary: #0D0A08;
            --color-bg-secondary: #1A1310;
            --color-surface: #2D2017;
            --color-surface-hover: #3D2B1F;
            --color-border: rgba(255, 127, 0, 0.2);
            --color-border-focus: #FF7F00;
            
            --color-accent-primary: #FF7F00;
            --color-accent-hover: #E66F00;
            --color-success: #10B981;
            --color-warning: #F59E0B;
            --color-error: #EF4444;
            
            --color-text-primary: #FFF8F0;
            --color-text-secondary: #E6D0B8;
            --color-text-muted: #A68A6B;
            --color-placeholder: #8B7355;
            
            --font-primary: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            --font-mono: 'JetBrains Mono', 'Menlo', 'Monaco', monospace;
            
            --spacing-xs: 4px;
            --spacing-sm: 8px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;
            --spacing-2xl: 48px;
            
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
            
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            
            --transition-fast: 0.15s ease-out;
            --transition-base: 0.3s ease-out;
            --transition-slow: 0.5s ease-out;
        }
        
        /* --- Global Reset --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        /* --- Body Styles --- */
        body {
            font-family: var(--font-primary);
            background: linear-gradient(135deg, var(--color-bg-primary) 0%, var(--color-bg-secondary) 100%);
            color: var(--color-text-primary);
            min-height: 100vh;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* --- Container Layout --- */
        .container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: var(--spacing-lg);
        }
        
        /* --- Main Card --- */
        .main-card {
            background: var(--color-bg-secondary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            padding: var(--spacing-2xl);
            max-width: 680px;
            width: 100%;
            box-shadow: var(--shadow-xl);
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }
        
        .main-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--color-accent-primary), transparent);
            opacity: 0.7;
        }
        
        /* --- Header Section --- */
        .header {
            text-align: center;
            margin-bottom: var(--spacing-2xl);
        }
        
        .logo {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 80px;
            height: 80px;
            border-radius: var(--radius-lg);
            margin-bottom: var(--spacing-lg);
            transition: transform var(--transition-base);
        }
        
        .logo:hover {
            transform: translateY(-2px) scale(1.05);
        }
        
        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .title {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            background: linear-gradient(135deg, var(--color-text-primary), var(--color-text-secondary));
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .custom-html-container {
            margin: var(--spacing-md) 0;
            color: var(--color-text-secondary);
        }
        
        .subtitle {
            color: var(--color-text-secondary);
            font-size: 16px;
            margin-bottom: var(--spacing-md);
            line-height: 1.5;
        }
        
        .links {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-lg);
            flex-wrap: wrap;
        }
        
        .link {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-xs);
            color: var(--color-accent-primary);
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
            transition: all var(--transition-fast);
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--radius-sm);
        }
        
        .link:hover {
            color: var(--color-accent-hover);
            background: rgba(255, 127, 0, 0.1);
        }
        
        .link svg {
            width: 16px;
            height: 16px;
        }
        
        .section {
            margin-bottom: var(--spacing-xl);
        }
        
        .section-title {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-size: 18px;
            font-weight: 600;
            color: var(--color-text-primary);
            margin-bottom: var(--spacing-lg);
            padding-bottom: var(--spacing-sm);
            border-bottom: 1px solid var(--color-border);
        }
        
        .section-title svg {
            width: 20px;
            height: 20px;
            color: var(--color-accent-primary);
        }
        
        /* --- Form Elements --- */
        .form-group {
            margin-bottom: var(--spacing-lg);
        }
        
        .form-label {
            display: block;
            color: var(--color-text-secondary);
            font-size: 14px;
            font-weight: 600;
            margin-bottom: var(--spacing-sm);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .input-group {
            position: relative;
        }
        
        .input-icon {
            position: absolute;
            left: var(--spacing-md);
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            color: var(--color-text-muted);
            pointer-events: none;
            transition: color var(--transition-fast);
        }
        
        .input {
            width: 100%;
            padding: var(--spacing-md) var(--spacing-md) var(--spacing-md) 48px;
            background: var(--color-bg-primary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            color: var(--color-text-primary);
            font-family: var(--font-primary);
            font-size: 16px;
            transition: all var(--transition-fast);
            outline: none;
        }
        
        .input::placeholder {
            color: var(--color-placeholder);
        }
        
        .input:focus {
            border-color: var(--color-border-focus);
            box-shadow: 0 0 0 3px rgba(255, 127, 0, 0.1);
        }
        
        .input:focus + .input-icon {
            color: var(--color-accent-primary);
        }
        
        .input[type="password"] {
            font-family: var(--font-mono);
        }
        
        .help-text {
            font-size: 14px;
            color: var(--color-text-muted);
            margin-top: var(--spacing-xs);
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }
        
        .help-text svg {
            width: 14px;
            height: 14px;
            flex-shrink: 0;
        }
        
        .help-text a {
            color: var(--color-accent-primary);
            text-decoration: none;
        }
        
        .help-text a:hover {
            text-decoration: underline;
        }
        
        /* --- Tags System --- */
        .tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-sm);
            margin-top: var(--spacing-sm);
            min-height: 40px;
            padding: var(--spacing-sm);
            background: var(--color-bg-primary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            transition: border-color var(--transition-fast);
        }
        
        .tags-container:focus-within {
            border-color: var(--color-border-focus);
        }
        
        .tag {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-xs);
            background: var(--color-accent-primary);
            color: white;
            padding: 6px var(--spacing-sm);
            border-radius: var(--radius-xl);
            font-size: 13px;
            font-weight: 500;
            animation: tagSlideIn 0.2s ease-out;
        }
        
        .tag-remove {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 16px;
            height: 16px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            font-size: 12px;
            transition: all var(--transition-fast);
        }
        
        .tag-remove:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }
        
        @keyframes tagSlideIn {
            from {
                opacity: 0;
                transform: scale(0.8) translateY(-10px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        /* --- Button Components --- */
        .button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            width: 100%;
            padding: var(--spacing-md) var(--spacing-lg);
            background: linear-gradient(135deg, var(--color-accent-primary), var(--color-accent-hover));
            color: white;
            border: none;
            border-radius: var(--radius-md);
            font-family: var(--font-primary);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
            position: relative;
            overflow: hidden;
        }
        
        .button:hover {
            transform: translateY(-1px);
            box-shadow: 0 8px 25px rgba(255, 127, 0, 0.4);
        }
        
        .button:active {
            transform: translateY(0);
        }
        
        .button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .button svg {
            width: 20px;
            height: 20px;
        }
        
        .button-secondary {
            background: var(--color-surface);
            color: var(--color-text-primary);
            border: 1px solid var(--color-border);
        }
        
        .button-secondary:hover {
            background: var(--color-surface-hover);
            box-shadow: var(--shadow-md);
        }
        
        /* --- Result Section --- */
        .result-card {
            display: none;
            background: var(--color-surface);
            border: 1px solid rgba(255, 127, 0, 0.3);
            border-radius: var(--radius-md);
            padding: var(--spacing-lg);
            margin-top: var(--spacing-xl);
            animation: slideIn 0.3s ease-out;
        }
        
        .result-title {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-size: 18px;
            font-weight: 600;
            color: var(--color-success);
            margin-bottom: var(--spacing-md);
        }
        
        .result-title svg {
            width: 20px;
            height: 20px;
        }
        
        .result-link {
            background: var(--color-bg-primary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-sm);
            padding: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 14px;
            color: var(--color-text-secondary);
            word-break: break-all;
            margin-bottom: var(--spacing-md);
        }
        
        .result-actions {
            display: flex;
            gap: var(--spacing-sm);
            flex-wrap: wrap;
        }
        
        .result-actions .button {
            width: auto;
            flex: 1;
            min-width: 120px;
        }
        
        /* --- Info Section --- */
        .info-card {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            padding: var(--spacing-lg);
            margin-top: var(--spacing-xl);
        }
        
        .info-title {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-size: 16px;
            font-weight: 600;
            color: var(--color-text-primary);
            margin-bottom: var(--spacing-md);
        }
        
        .info-title svg {
            width: 18px;
            height: 18px;
            color: var(--color-accent-primary);
        }
        
        .info-content {
            font-size: 14px;
            color: var(--color-text-secondary);
            line-height: 1.6;
        }
        
        .info-content strong {
            color: var(--color-text-primary);
        }
        
        .info-content a {
            color: var(--color-accent-primary);
            text-decoration: none;
        }
        
        .info-content a:hover {
            text-decoration: underline;
        }
        
        /* --- Animations --- */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .loading {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.7;
            }
        }
        
        /* --- Responsive Design --- */
        @media (max-width: 640px) {
            .container {
                padding: var(--spacing-md);
            }
            
            .main-card {
                padding: var(--spacing-lg);
            }
            
            .title {
                font-size: 28px;
            }
            
            .result-actions {
                flex-direction: column;
            }
            
            .result-actions .button {
                width: 100%;
            }
            
            .links {
                flex-direction: column;
                gap: var(--spacing-sm);
            }
        }
        
        .custom-html-container {
            color: var(--color-text-secondary);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="main-card">
            <header class="header">
                <div class="logo">
                    <img src="/static/wawacity_icon.png" alt="Wawacity Addon" style="width: 100%; height: 100%; object-fit: contain;">
                </div>
                
                <h1 class="title">Wawacity Addon</h1>
                
                <div class="custom-html-container">{{CUSTOM_HTML}}</div>
                
                <p class="subtitle">
                    Accès au contenu de Wawacity via Stremio & AllDebrid (non officiel)
                </p>
                
                <div class="links">
                    <a href="https://github.com/spel987/Wawacity-Stremio-Addon" target="_blank" class="link">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd" />
                        </svg>
                        GitHub
                    </a>
                    <a href="https://wawacity.diy" target="_blank" class="link">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path fill-rule="evenodd" d="M19.902 4.098a3.75 3.75 0 00-5.304 0l-4.5 4.5a3.75 3.75 0 001.035 6.037.75.75 0 01-.646 1.353 5.25 5.25 0 01-1.449-8.45l4.5-4.5a5.25 5.25 0 117.424 7.424l-1.757 1.757a.75.75 0 11-1.06-1.06l1.757-1.757a3.75 3.75 0 000-5.304zm-7.804 9.804a3.75 3.75 0 00-1.035-6.037.75.75 0 01.646-1.353 5.25 5.25 0 011.449 8.45l-4.5 4.5a5.25 5.25 0 01-7.424-7.424l1.757-1.757a.75.75 0 111.06 1.06l-1.757 1.757a3.75 3.75 0 105.304 5.304l4.5-4.5z" clip-rule="evenodd" />
                        </svg>
                        Wawacity
                    </a>
                </div>
            </header>

            <section class="section">
                <h2 class="section-title">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path fill-rule="evenodd" d="M11.078 2.25c-.917 0-1.699.663-1.85 1.567L9.05 4.889c-.02.12-.115.26-.297.348a7.493 7.493 0 00-.986.57c-.166.115-.334.126-.45.083L6.3 5.508a1.875 1.875 0 00-2.282.819l-.922 1.597a1.875 1.875 0 00.432 2.385l.84.692c.095.078.17.229.154.43a7.598 7.598 0 000 1.139c.015.2-.059.352-.153.43l-.841.692a1.875 1.875 0 00-.432 2.385l.922 1.597a1.875 1.875 0 002.282.818l1.019-.382c.115-.043.283-.031.45.082.312.214.641.405.985.57.182.088.277.228.297.35l.178 1.071c.151.904.933 1.567 1.85 1.567h1.844c.916 0 1.699-.663 1.85-1.567l.178-1.072c.02-.12.114-.26.297-.349.344-.165.673-.356.985-.570.167-.114.335-.125.45-.082l1.02.382a1.875 1.875 0 002.28-.819l.923-1.597a1.875 1.875 0 00-.432-2.385l-.84-.692c-.095-.078-.17-.229-.154-.43a7.614 7.614 0 000-1.139c-.016-.2.059-.352.153-.43l.84-.692c.708-.582.891-1.59.433-2.385l-.922-1.597a1.875 1.875 0 00-2.282-.818l-1.02.382c-.114.043-.282.031-.449-.083a7.49 7.49 0 00-.985-.57c-.183-.087-.277-.227-.297-.348l-.179-1.072a1.875 1.875 0 00-1.85-1.567h-1.843zM12 15.75a3.75 3.75 0 100-7.5 3.75 3.75 0 000 7.5z" clip-rule="evenodd" />
                    </svg>
                    Configuration API
                </h2>

                <div class="form-group">
                    <label class="form-label" for="alldebrid">Clé API AllDebrid</label>
                    <div class="input-group">
                        <input type="text" id="alldebrid" class="input" placeholder="Votre clé API AllDebrid" autocomplete="off">
                        <svg class="input-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path fill-rule="evenodd" d="M12 1.5a5.25 5.25 0 00-5.25 5.25v3a3 3 0 00-3 3v6.75a3 3 0 003 3h10.5a3 3 0 003-3v-6.75a3 3 0 00-3-3v-3c0-2.9-2.35-5.25-5.25-5.25zm3.75 8.25v-3a3.75 3.75 0 10-7.5 0v3h7.5z" clip-rule="evenodd" />
                        </svg>
                    </div>
                    <div class="help-text">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm8.706-1.442c1.146-.573 2.437.463 2.126 1.706l-.709 2.836.042-.02a.75.75 0 01.67 1.34l-.04.022c-1.147.573-2.438-.463-2.127-1.706l.71-2.836-.042.02a.75.75 0 11-.67-1.34l.04-.022zM12 9a.75.75 0 100-1.5.75.75 0 000 1.5z" clip-rule="evenodd" />
                        </svg>
                        Obtenez votre clé API depuis <a href="https://alldebrid.com/apikeys" target="_blank">alldebrid.com/apikeys</a>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="tmdb">Token d'accès TMDB</label>
                    <div class="input-group">
                        <input type="text" id="tmdb" class="input" placeholder="Votre token d'accès TMDB" autocomplete="off">
                        <svg class="input-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0016.5 9h-1.875a1.875 1.875 0 01-1.875-1.875V5.25A3.75 3.75 0 009 1.5H5.625z" />
                            <path d="M12.971 1.816A5.23 5.23 0 0114.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 013.434 1.279 9.768 9.768 0 00-6.963-6.963z" />
                        </svg>
                    </div>
                    <div class="help-text">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm8.706-1.442c1.146-.573 2.437.463 2.126 1.706l-.709 2.836.042-.02a.75.75 0 01.67 1.34l-.04.022c-1.147.573-2.438-.463-2.127-1.706l.71-2.836-.042.02a.75.75 0 11-.67-1.34l.04-.022zM12 9a.75.75 0 100-1.5.75.75 0 000 1.5z" clip-rule="evenodd" />
                        </svg>
                        Obtenez votre token depuis <a href="https://www.themoviedb.org/settings/api" target="_blank">themoviedb.org/settings/api</a>
                    </div>
                </div>
            </section>

            <section class="section">
                <h2 class="section-title">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path fill-rule="evenodd" d="M3.792 2.938A49.069 49.069 0 0112 2.25c2.797 0 5.54.236 8.209.688a1.857 1.857 0 011.541 1.836v1.044a3 3 0 01-.879 2.121l-6.182 6.182a1.5 1.5 0 00-.439 1.061v2.927a3 3 0 01-1.658 2.684l-1.757.878A.75.75 0 019.75 21v-5.818a1.5 1.5 0 00-.44-1.06L3.130 7.938a3 3 0 01-.879-2.121V4.774c0-.897.64-1.683 1.542-1.836z" clip-rule="evenodd" />
                    </svg>
                    Filtrage du Contenu
                </h2>

                <div class="form-group">
                    <label class="form-label" for="excludedWordInput">Mots exclus</label>
                    <div class="input-group">
                        <input type="text" id="excludedWordInput" class="input" placeholder="Tapez un mot à exclure et appuyez sur Entrée">
                        <svg class="input-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path fill-rule="evenodd" d="M5.25 2.25a3 3 0 00-3 3v4.318a3 3 0 00.879 2.121l9.58 9.581c.92.92 2.39 1.186 3.548.428a18.849 18.849 0 005.441-5.44c.758-1.16.492-2.629-.428-3.548l-9.58-9.581a3 3 0 00-2.122-.879H5.25zM6.375 7.5a1.125 1.125 0 100-2.25 1.125 1.125 0 000 2.25z" clip-rule="evenodd" />
                        </svg>
                    </div>
                    <div class="help-text">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path fill-rule="evenodd" d="M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z" clip-rule="evenodd" />
                        </svg>
                        Les streams contenant ces mots seront filtrés (insensible à la casse)
                    </div>
                    <div id="excludedWordsTags" class="tags-container" style="display: none;"></div>
                </div>
            </section>

            <section class="section" id="passwordSection" style="display: none;">
                <h2 class="section-title">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path fill-rule="evenodd" d="M12.516 2.17a.75.75 0 00-1.032 0 11.209 11.209 0 01-7.877 3.08.75.75 0 00-.722.515A12.74 12.74 0 002.25 9.75c0 5.814 3.720 10.764 9.75 12.814 6.03-2.050 9.75-7.000 9.75-12.814 0-1.429-.232-2.804-.665-4.096a.75.75 0 00-.722-.515 11.209 11.209 0 01-7.877-3.08zM15.75 9.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 2.25a.75.75 0 100 1.5.75.75 0 000-1.5zm-3-6a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 2.25a.75.75 0 100 1.5.75.75 0 000-1.5zm-3-6a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 2.25a.75.75 0 100 1.5.75.75 0 000-1.5zM9 15a.75.75 0 11-1.5 0 .75.75 0 011.5 0z" clip-rule="evenodd" />
                    </svg>
                    Sécurité
                </h2>

                <div class="form-group">
                    <label class="form-label" for="addonPassword">Mot de passe</label>
                    <div class="input-group">
                        <input type="password" id="addonPassword" class="input" placeholder="Entrez le mot de passe">
                        <svg class="input-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path fill-rule="evenodd" d="M12 1.5a5.25 5.25 0 00-5.25 5.25v3a3 3 0 00-3 3v6.75a3 3 0 003 3h10.5a3 3 0 003-3v-6.75a3 3 0 00-3-3v-3c0-2.9-2.35-5.25-5.25-5.25zm3.75 8.25v-3a3.75 3.75 0 10-7.5 0v3h7.5z" clip-rule="evenodd" />
                        </svg>
                    </div>
                    <div class="help-text">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z" clip-rule="evenodd" />
                        </svg>
                        Ce mot de passe est requis pour générer la configuration de l'addon
                    </div>
                </div>
            </section>

            <button id="generateBtn" class="button" onclick="generateLink()">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path fill-rule="evenodd" d="M12 2.25a.75.75 0 01.75.75v11.69l3.22-3.22a.75.75 0 111.06 1.06l-4.5 4.5a.75.75 0 01-1.06 0l-4.5-4.5a.75.75 0 111.06-1.06l3.22 3.22V3a.75.75 0 01.75-.75zm-9 13.5a.75.75 0 01.75.75v2.25a1.5 1.5 0 001.5 1.5h13.5a1.5 1.5 0 001.5-1.5V16.5a.75.75 0 011.5 0v2.25a3 3 0 01-3 3H5.25a3 3 0 01-3-3V16.5a.75.75 0 01.75-.75z" clip-rule="evenodd" />
                </svg>
                Générer le Lien de l'Addon
            </button>

            <div id="result" class="result-card">
                <div class="result-title">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z" clip-rule="evenodd" />
                    </svg>
                    Addon Configuré avec Succès
                </div>
                <div id="addonLink" class="result-link"></div>
                <div class="result-actions">
                    <button class="button button-secondary" onclick="copyToClipboard('addonLink')">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path fill-rule="evenodd" d="M10.5 3A1.501 1.501 0 009 4.5h6A1.5 1.5 0 0013.5 3h-3zm-2.693.178A3 3 0 0110.5 1.5h3a3 3 0 012.694 1.678c.497.042.992.092 1.486.15 1.497.173 2.57 1.46 2.57 2.929V19.5a3 3 0 01-3 3H6.75a3 3 0 01-3-3V6.257c0-1.47 1.073-2.756 2.57-2.93.493-.057.989-.107 1.487-.15z" clip-rule="evenodd" />
                        </svg>
                        Copier le Lien
                    </button>
                    <button class="button" onclick="openInStremio()">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" />
                        </svg>
                        Ouvrir dans Stremio
                    </button>
                </div>
            </div>

            <div class="info-card">
                <div class="info-title">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm8.706-1.442c1.146-.573 2.437.463 2.126 1.706l-.709 2.836.042-.02a.75.75 0 01.67 1.34l-.04.022c-1.147.573-2.438-.463-2.127-1.706l.71-2.836-.042.02a.75.75 0 11-.67-1.34l.04-.022zM12 9a.75.75 0 100-1.5.75.75 0 000 1.5z" clip-rule="evenodd" />
                    </svg>
                    Comment obtenir les clés API
                </div>
                <div class="info-content">
                    <p><strong>AllDebrid (Premium requis):</strong> Connectez-vous sur <a href="https://alldebrid.com/apikeys" target="_blank">alldebrid.com/apikeys</a> et générez votre clé API</p><br>
                    <p><strong>TMDB (Compte gratuit):</strong> Créez un compte et obtenez votre token depuis <a href="https://www.themoviedb.org/settings/api" target="_blank">themoviedb.org/settings/api</a></p>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // --- Global Variables ---
        let excludedWords = [];
        let passwordRequired = false;

        // --- Excluded Words Management ---
        function addExcludedWord() {
            const input = document.getElementById('excludedWordInput');
            const word = input.value.trim().toLowerCase();
            
            if (!word) return;
            if (word.includes(' ')) {
                showNotification('Les mots ne peuvent pas contenir d\'espaces', 'error');
                return;
            }
            if (excludedWords.includes(word)) {
                showNotification('Ce mot est déjà dans la liste', 'warning');
                return;
            }
            
            excludedWords.push(word);
            input.value = '';
            updateTagsDisplay();
            showNotification(`"${word}" ajouté à la liste de filtrage`, 'success');
        }

        function removeExcludedWord(word) {
            excludedWords = excludedWords.filter(w => w !== word);
            updateTagsDisplay();
            showNotification(`"${word}" supprimé de la liste de filtrage`, 'success');
        }

        function updateTagsDisplay() {
            const container = document.getElementById('excludedWordsTags');
            container.innerHTML = '';
            
            if (excludedWords.length === 0) {
                container.style.display = 'none';
            } else {
                container.style.display = 'flex';
                
                excludedWords.forEach(word => {
                    const tag = document.createElement('div');
                    tag.className = 'tag';
                    tag.innerHTML = `
                        <span>${word}</span>
                        <button class="tag-remove" onclick="removeExcludedWord('${word}')" type="button">×</button>
                    `;
                    container.appendChild(tag);
                });
            }
        }

        async function generateLink() {
            const alldebrid = document.getElementById('alldebrid').value.trim();
            const tmdb = document.getElementById('tmdb').value.trim();
            const password = document.getElementById('addonPassword').value.trim();
            const generateBtn = document.getElementById('generateBtn');
            
            if (!alldebrid || !tmdb) {
                showNotification('Veuillez remplir les deux champs API', 'error');
                return;
            }
            
            generateBtn.classList.add('loading');
            generateBtn.innerHTML = `
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M4.5 12a7.5 7.5 0 0015 0 7.5 7.5 0 00-15 0zm7.5-3a.75.75 0 01.75.75v1.5h1.5a.75.75 0 010 1.5h-1.5v1.5a.75.75 0 01-1.5 0v-1.5H9.25a.75.75 0 010-1.5h1.5V9.75A.75.75 0 0112 9z"/>
                </svg>
                Génération...
            `;
            generateBtn.disabled = true;
            
            try {
                if (passwordRequired) {
                    if (!password) {
                        showNotification('Le mot de passe admin est requis', 'error');
                        return;
                    }
                    
                    const response = await fetch(`/verify-password?password=${encodeURIComponent(password)}`, {
                        method: 'POST'
                    });
                    const data = await response.json();
                    
                    if (!data.valid) {
                        showNotification('Mot de passe incorrect', 'error');
                        return;
                    }
                }
                
                const config = {
                    alldebrid: alldebrid,
                    tmdb: tmdb,
                    excluded_words: excludedWords
                };
                const configBase64 = btoa(JSON.stringify(config));
                const addonUrl = `${window.location.protocol}//${window.location.host}/${configBase64}/manifest.json`;
                
                document.getElementById('addonLink').textContent = addonUrl;
                document.getElementById('result').style.display = 'block';
                document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
                
                showNotification('Lien de l\'addon généré avec succès !', 'success');
                
            } catch (error) {
                showNotification('Une erreur s\'est produite lors de la génération du lien', 'error');
                console.error('Error:', error);
            } finally {
                generateBtn.classList.remove('loading');
                generateBtn.innerHTML = `
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path fill-rule="evenodd" d="M12 2.25a.75.75 0 01.75.75v11.69l3.22-3.22a.75.75 0 111.06 1.06l-4.5 4.5a.75.75 0 01-1.06 0l-4.5-4.5a.75.75 0 111.06-1.06l3.22 3.22V3a.75.75 0 01.75-.75zm-9 13.5a.75.75 0 01.75.75v2.25a1.5 1.5 0 001.5 1.5h13.5a1.5 1.5 0 001.5-1.5V16.5a.75.75 0 011.5 0v2.25a3 3 0 01-3 3H5.25a3 3 0 01-3-3V16.5a.75.75 0 01.75-.75z" clip-rule="evenodd" />
                    </svg>
                    Générer le Lien de l'Addon
                `;
                generateBtn.disabled = false;
            }
        }
        
        // --- Clipboard Operations ---
        function copyToClipboard(elementId) {
            const text = document.getElementById(elementId).textContent;
            const btn = event.target.closest('button');
            const originalHTML = btn.innerHTML;
            
            navigator.clipboard.writeText(text).then(() => {
                btn.innerHTML = `
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z" clip-rule="evenodd" />
                    </svg>
                    Copié !
                `;
                showNotification('Lien copié avec succès !', 'success');
                setTimeout(() => {
                    btn.innerHTML = originalHTML;
                }, 2000);
            }).catch(() => {
                showNotification('Erreur lors de la copie du lien', 'error');
                setTimeout(() => {
                    btn.innerHTML = originalHTML;
                }, 2000);
            });
        }
        
        // --- Stremio Integration ---
        function openInStremio() {
            const addonUrl = document.getElementById('addonLink').textContent;
            const urlWithoutProtocol = addonUrl.replace(/^https?:\/\//, '');
            const stremioUrl = `stremio://${urlWithoutProtocol}`;
            window.open(stremioUrl, '_blank');
            showNotification('Ouverture dans Stremio...', 'success');
        }
        
        // --- Notification System ---
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 12px 16px;
                border-radius: 8px;
                color: white;
                font-weight: 500;
                font-size: 14px;
                z-index: 1000;
                animation: slideInRight 0.3s ease-out;
                max-width: 400px;
                box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            `;
            
            const rootStyles = getComputedStyle(document.documentElement);
            switch (type) {
                case 'success':
                    notification.style.background = rootStyles.getPropertyValue('--color-success').trim();
                    break;
                case 'error':
                    notification.style.background = rootStyles.getPropertyValue('--color-error').trim();
                    break;
                case 'warning':
                    notification.style.background = rootStyles.getPropertyValue('--color-warning').trim();
                    break;
                default:
                    notification.style.background = rootStyles.getPropertyValue('--color-accent-primary').trim();
            }
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease-out';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }
        
        // --- Dynamic Styles ---
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            
            @keyframes slideOutRight {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(100%);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // --- Configuration Loading ---
        async function loadPasswordConfig() {
            try {
                const response = await fetch('/password-config');
                const data = await response.json();
                passwordRequired = data.password_required;
                
                if (passwordRequired) {
                    document.getElementById('passwordSection').style.display = 'block';
                }
            } catch (error) {
                console.error('Error loading password config:', error);
            }
        }

        // --- Event Listeners ---
        document.getElementById('alldebrid').focus();
        loadPasswordConfig();
        document.addEventListener('keypress', function(e) {
            if (e.target.id === 'excludedWordInput' && e.key === 'Enter') {
                e.preventDefault();
                addExcludedWord();
            } else if (e.key === 'Enter' && e.target.id !== 'excludedWordInput') {
                generateLink();
            }
        });
    </script>
</body>
</html>